# Chat Input & Composer Specification

**Status**: Draft
**Created**: 2026-01-19
**Owner**: Eric

## 背景与目标
输入层是用户与对话系统的唯一入口，当前交互与状态分散在多个组件与 composables 中。目标是定义最小稳定边界，使输入状态、快捷操作与提交逻辑可独立演进。

## 术语与边界
- **Composer**：输入区的状态与行为集合。
- **Draft**：与会话绑定的未发送输入状态。
- **Submission**：将输入内容提交给执行适配层。

## 相关文档
- `docs/specs/domain-conversation/domain-conversation.md`

## 范围（In Scope）
- 输入框状态、草稿持久化与恢复。
- 附件与链接的输入组织与校验（仅元数据）。
- 快捷键与输入历史管理。
- 发送前的结构化内容构建与提交触发。
- 会话级输入标记（如 think/search flags）的传递。

## 非目标（Out of Scope）
- 消息执行、流式处理与重试。
- 模型/供应商能力校验。
- 工具执行与结果处理。
- 语音与音频能力。

## 用户故事
- 用户输入内容并发送，系统正确构建消息内容。
- 用户切换会话后草稿自动恢复。
- 用户通过快捷键快速插入/提交内容。

## 验收标准
- 输入层不直接调用 presenter，仅依赖适配层。
- 草稿与附件状态与会话绑定，不跨会话污染。
- 提交行为可被单独测试（无 UI 依赖）。

## 约束与假设
- Conversation ID 作为草稿和输入状态的唯一绑定键。
- 输入层不处理执行成功与失败，仅触发提交。

## 开放问题
无。如需纳入新输入能力，需扩展该规范。
