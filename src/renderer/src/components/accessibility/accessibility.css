/* 无障碍全局样式 */

/* 键盘焦点指示器增强 */
.keyboard-focus *:focus {
  outline: 2px solid hsl(var(--ring));
  outline-offset: 2px;
}

.mouse-focus *:focus {
  outline: 1px solid hsl(var(--ring));
  outline-offset: 1px;
}

/* 跳过链接样式增强 */
.skip-links a:focus {
  position: static !important;
  left: auto !important;
  top: auto !important;
  width: auto !important;
  height: auto !important;
  overflow: visible !important;
}

/* 焦点陷阱容器 */
.focus-trap-active {
  isolation: isolate;
}

.focus-trap-active *:focus {
  outline: 2px solid hsl(var(--primary));
  outline-offset: 2px;
}

/* 高对比度模式支持 */
@media (prefers-contrast: high) {
  .skip-links a:focus {
    border: 3px solid;
    outline: 3px solid;
  }

  .keyboard-focus *:focus,
  .mouse-focus *:focus {
    outline: 3px solid;
    outline-offset: 3px;
  }

  /* 确保在高对比度模式下按钮和链接有明显边界 */
  button,
  a,
  input,
  select,
  textarea {
    border: 1px solid;
  }
}

/* 减少动画首选项支持 */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* 屏幕阅读器专用内容 */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* 焦点增强 */
.focus-enhanced:focus-within {
  box-shadow: 0 0 0 2px hsl(var(--ring));
  border-radius: 4px;
}

/* 无障碍通知区域 */
.a11y-announcer {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* 对话框无障碍增强 */
.dialog-content[role='dialog'] {
  max-height: 90vh;
  max-width: 90vw;
  overflow-y: auto;
}

.dialog-content:focus-within {
  outline: 2px solid hsl(var(--ring));
  outline-offset: -2px;
}

/* 键盘导航增强 */
.keyboard-nav-container:focus-within .nav-item:focus {
  background-color: hsl(var(--accent));
  color: hsl(var(--accent-foreground));
}

/* 状态指示器 */
[aria-expanded='true'] .expand-icon {
  transform: rotate(180deg);
}

[aria-expanded='false'] .expand-icon {
  transform: rotate(0deg);
}

/* 禁用状态视觉增强 */
[aria-disabled='true'],
[disabled] {
  opacity: 0.5;
  cursor: not-allowed;
}

/* 选中状态增强 */
[aria-selected='true'] {
  background-color: hsl(var(--primary));
  color: hsl(var(--primary-foreground));
}

[aria-checked='true']::before {
  content: '✓';
  margin-right: 0.5rem;
}

/* 错误状态 */
[aria-invalid='true'] {
  border-color: hsl(var(--destructive));
  box-shadow: 0 0 0 1px hsl(var(--destructive));
}

/* 必填字段指示 */
[aria-required='true'] label::after {
  content: ' *';
  color: hsl(var(--destructive));
}

/* 加载状态 */
[aria-busy='true'] {
  cursor: wait;
  opacity: 0.7;
}

/* 实时区域 */
[aria-live='polite'],
[aria-live='assertive'] {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* 工具提示增强 */
[role='tooltip'] {
  position: absolute;
  z-index: 10000;
  padding: 0.5rem;
  background: hsl(var(--popover));
  color: hsl(var(--popover-foreground));
  border: 1px solid hsl(var(--border));
  border-radius: 4px;
  font-size: 0.875rem;
  max-width: 200px;
  word-wrap: break-word;
}

/* 进度条无障碍增强 */
[role='progressbar'] {
  overflow: hidden;
  border-radius: 4px;
  background-color: hsl(var(--secondary));
}

[role='progressbar']::after {
  content: attr(aria-valuenow) '% ' attr(aria-label);
  position: absolute;
  left: -10000px;
}

/* 标签页无障碍增强 */
[role='tablist'] {
  display: flex;
  border-bottom: 1px solid hsl(var(--border));
}

[role='tab'] {
  padding: 0.5rem 1rem;
  cursor: pointer;
  border-bottom: 2px solid transparent;
}

[role='tab'][aria-selected='true'] {
  border-bottom-color: hsl(var(--primary));
  background-color: hsl(var(--background));
}

[role='tab']:focus {
  outline: 2px solid hsl(var(--ring));
  outline-offset: -2px;
}

[role='tabpanel'] {
  padding: 1rem;
  min-height: 200px;
}

[role='tabpanel']:focus {
  outline: 2px solid hsl(var(--ring));
  outline-offset: 2px;
}
